<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>FediAlgo Class: MastoApi</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: MastoApi</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>MastoApi<span class="signature">(api, user)</span><span class="type-signature"></span></h2>
        
            <div class="class-description">Singleton class for interacting with the authenticated Mastodon API for the user's home server.
Handles caching, concurrency, and provides methods for fetching and updating Mastodon data.</div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="MastoApi"><span class="type-signature"></span>new MastoApi<span class="signature">(api, user)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Private constructor for MastoApi. Instantiate with `MastoApi.init()`.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>api</code></td>
            

            <td class="type">
            
                
<span class="param-type">mastodon.rest.Client</span>


            
            </td>

            

            

            <td class="description last">Mastodon REST API client.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>user</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Account.html">Account</a></span>


            
            </td>

            

            

            <td class="description last">The authenticated user account.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















    
    </div>

    

    

    

    

    

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="api"><span class="type-signature"></span>api<span class="type-signature"></span></h4>




<div class="description">
    Mastodon REST API client instance.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="apiErrors"><span class="type-signature"></span>apiErrors<span class="type-signature"></span></h4>




<div class="description">
    Errors encountered while using the API.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="homeDomain"><span class="type-signature"></span>homeDomain<span class="type-signature"></span></h4>




<div class="description">
    The Fedialgo user's home server domain.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="logger"><span class="type-signature"></span>logger<span class="type-signature"></span></h4>




<div class="description">
    API logger.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="user"><span class="type-signature"></span>user<span class="type-signature"></span></h4>




<div class="description">
    The Fedialgo user's Account object'.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="userData"><span class="type-signature"></span>userData<span class="type-signature"></span></h4>




<div class="description">
    The Fedialgo user's historical info.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id="waitTimes"><span class="type-signature"></span>waitTimes<span class="type-signature"></span></h4>




<div class="description">
    Tracks the amount of time spent waiting for each endpoint's API responses.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
            
<h4 class="name" id=".instance"><span class="type-signature">(static) </span>instance<span class="type-signature"></span></h4>




<div class="description">
    Returns the singleton instance of MastoApi.
</div>







<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="fetchHomeFeed"><span class="type-signature">(async) </span>fetchHomeFeed<span class="signature">(params)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>>}</span></h4>
    

    



<div class="description">
    Fetches the user's home timeline feed (recent toots from followed accounts and hashtags).
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">HomeTimelineParams</span>


            
            </td>

            

            

            <td class="description last">Parameters for fetching the home feed.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of Toots in the home feed.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="fillInDefaultParams"><span class="type-signature"></span>fillInDefaultParams<span class="signature">(params)</span><span class="type-signature"> &rarr; {FetchParamsWithDefaults.&lt;T>}</span></h4>
    

    



<div class="description">
    Populates fetch options with basic defaults for API requests.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">FetchParams.&lt;T></span>


            
            </td>

            

            

            <td class="description last">Fetch parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Fetch parameters with defaults filled in.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">FetchParamsWithDefaults.&lt;T></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getBlockedAccounts"><span class="type-signature">(async) </span>getBlockedAccounts<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>>}</span></h4>
    

    



<div class="description">
    Gets the accounts blocked by the user (does not include muted accounts).
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of blocked accounts.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getCacheableToots"><span class="type-signature">(async) </span>getCacheableToots<span class="signature">(fetchStatuses, cacheKey, maxRecords)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>>}</span></h4>
    

    



<div class="description">
    Generic data getter for cacheable toots with custom fetch logic.
Used for various hashtag feeds (participated, trending, favourited).
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>fetchStatuses</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last">Function to fetch statuses.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>cacheKey</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiCacheKey</span>


            
            </td>

            

            

            <td class="description last">Cache key for storage.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>maxRecords</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">Maximum number of records to fetch.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of Toots.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getFavouritedToots"><span class="type-signature">(async) </span>getFavouritedToots<span class="signature">(params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>>}</span></h4>
    

    



<div class="description">
    Gets the toots recently favourited by the user.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiParams</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of favourited Toots.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getFollowedAccounts"><span class="type-signature">(async) </span>getFollowedAccounts<span class="signature">(params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>>}</span></h4>
    

    



<div class="description">
    Gets the accounts followed by the user.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiParams</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of followed accounts.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getFollowedTags"><span class="type-signature">(async) </span>getFollowedTags<span class="signature">(params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;mastodon.v1.Tag>>}</span></h4>
    

    



<div class="description">
    Gets the hashtags followed by the user.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiParams</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of followed tags.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;mastodon.v1.Tag>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getFollowers"><span class="type-signature">(async) </span>getFollowers<span class="signature">(params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>>}</span></h4>
    

    



<div class="description">
    Gets the followers of the Fedialgo user.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiParams</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of follower accounts.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getMutedAccounts"><span class="type-signature">(async) </span>getMutedAccounts<span class="signature">(params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>>}</span></h4>
    

    



<div class="description">
    Gets all muted accounts (including fully blocked accounts).
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiParams</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of muted and blocked accounts.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Account.html">Account</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getNotifications"><span class="type-signature">(async) </span>getNotifications<span class="signature">(params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;mastodon.v1.Notification>>}</span></h4>
    

    



<div class="description">
    Gets the user's recent notifications.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiParamsWithMaxID</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of notifications.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;mastodon.v1.Notification>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getRecentUserToots"><span class="type-signature">(async) </span>getRecentUserToots<span class="signature">(params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>>}</span></h4>
    

    



<div class="description">
    Gets the user's recent toots.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">ApiParamsWithMaxID</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Optional parameters.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of recent user Toots.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getServerSideFilters"><span class="type-signature">(async) </span>getServerSideFilters<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;mastodon.v2.Filter>>}</span></h4>
    

    



<div class="description">
    Retrieves content-based feed filters set up by the user on the server.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of server-side filters.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;mastodon.v2.Filter>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getStatusesForTag"><span class="type-signature">(async) </span>getStatusesForTag<span class="signature">(tagName, logger, numToots<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;TootLike>>}</span></h4>
    

    



<div class="description">
    Gets the latest toots for a given tag using both the Search API and tag timeline API.
The two APIs give results with surprisingly little overlap (~80% of toots are unique).
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>tagName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The tag to search for.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>logger</code></td>
            

            <td class="type">
            
                
<span class="param-type">Logger</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Logger instance for logging.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>numToots</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Number of toots to fetch.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of TootLike objects.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;TootLike>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="getUserData"><span class="type-signature">(async) </span>getUserData<span class="signature">(force<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;<a href="UserData.html">UserData</a>>}</span></h4>
    

    



<div class="description">
    Retrieves background data about the user for scoring, etc. Caches as an instance variable.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>force</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">If true, forces a refresh from the API.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    The user data object.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;<a href="UserData.html">UserData</a>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="hashtagTimelineToots"><span class="type-signature">(async) </span>hashtagTimelineToots<span class="signature">(tagName, logger, maxRecords<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>>}</span></h4>
    

    



<div class="description">
    Fetches toots from the tag timeline API (different from the search API).
Concurrency is managed by a semaphore. See https://docs.joinmastodon.org/methods/v1/timelines/#tag
TODO: Could maybe use min_id and max_id to avoid re-fetching the same data
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>tagName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The tag to fetch toots for.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>logger</code></td>
            

            <td class="type">
            
                
<span class="param-type">Logger</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Logger instance for logging.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>maxRecords</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Maximum number of records to fetch.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of Toots.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;<a href="Toot.html">Toot</a>>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="instanceInfo"><span class="type-signature">(async) </span>instanceInfo<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;mastodon.v2.Instance>}</span></h4>
    

    



<div class="description">
    Retrieves the user's home instance (mastodon server) configuration from the API.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    The instance configuration.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;mastodon.v2.Instance></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="lockAllMutexes"><span class="type-signature">(async) </span>lockAllMutexes<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;ConcurrencyLockRelease>>}</span></h4>
    

    



<div class="description">
    Locks all API and cache mutexes for cache state operations.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of lock release functions.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;ConcurrencyLockRelease>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="loggerForParams"><span class="type-signature"></span>loggerForParams<span class="signature">(params)</span><span class="type-signature"> &rarr; {Logger}</span></h4>
    

    



<div class="description">
    Returns a logger instance for the given fetch parameters.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type">Omit.&lt;FetchParams.&lt;T>, "fetch"></span>


            
            </td>

            

            

            <td class="description last">Fetch parameters (excluding fetch).</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Logger instance.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Logger</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="reset"><span class="type-signature"></span>reset<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Resets the API state, clearing errors and user data, and resetting concurrency.
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="resolveToot"><span class="type-signature">(async) </span>resolveToot<span class="signature">(toot)</span><span class="type-signature"> &rarr; {Promise.&lt;<a href="Toot.html">Toot</a>>}</span></h4>
    

    



<div class="description">
    Resolves a foreign server toot URI to one on the user's local server using the v2 search API.
transforms URLs like this: https://fosstodon.org/@kate/114360290341300577
                  to this: https://universeodon.com/@kate@fosstodon.org/114360290578867339
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>toot</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Toot.html">Toot</a></span>


            
            </td>

            

            

            <td class="description last">The toot to resolve.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    The resolved toot.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;<a href="Toot.html">Toot</a>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="searchForToots"><span class="type-signature">(async) </span>searchForToots<span class="signature">(searchStr, logger, maxRecords<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;mastodon.v1.Status>>}</span></h4>
    

    



<div class="description">
    Performs a keyword substring search for toots using the search API.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>searchStr</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">The string to search for.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>logger</code></td>
            

            <td class="type">
            
                
<span class="param-type">Logger</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last">Logger instance for logging.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>maxRecords</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last">Maximum number of records to fetch.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of status objects.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;mastodon.v1.Status>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setSemaphoreConcurrency"><span class="type-signature"></span>setSemaphoreConcurrency<span class="signature">(concurrency)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Sets the concurrency for the request semaphore.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>concurrency</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">The new concurrency value.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="tagUrl"><span class="type-signature"></span>tagUrl<span class="signature">(tag)</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Returns the URL for a tag on the user's home server.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>tag</code></td>
            

            <td class="type">
            
                
<span class="param-type">MastodonTag</span>
|

<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The tag or tag object.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    The tag URL.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".init"><span class="type-signature">(async, static) </span>init<span class="signature">(api, user)</span><span class="type-signature"> &rarr; {Promise.&lt;void>}</span></h4>
    

    



<div class="description">
    Initializes the singleton MastoApi instance with the provided Mastodon API client and user account.
If an instance already exists, logs a warning and does nothing.
Loads user data from storage and assigns it to the instance.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>api</code></td>
            

            <td class="type">
            
                
<span class="param-type">mastodon.rest.Client</span>


            
            </td>

            

            

            <td class="description last">The Mastodon REST API client.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>user</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Account.html">Account</a></span>


            
            </td>

            

            

            <td class="description last">The authenticated user account.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Resolves when initialization is complete.
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;void></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id=".throwIfAccessTokenRevoked"><span class="type-signature">(static) </span>throwIfAccessTokenRevoked<span class="signature">(logger, error, msg)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Throws if the error is an access token revoked error, otherwise logs and moves on.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>logger</code></td>
            

            <td class="type">
            
                
<span class="param-type">Logger</span>


            
            </td>

            

            

            <td class="description last">Logger instance.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>error</code></td>
            

            <td class="type">
            
                
<span class="param-type">unknown</span>


            
            </td>

            

            

            <td class="description last">The error to check.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>msg</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Message to log.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        If the error is an access token revoked error.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">unknown</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    







        
            

    

    
    <h4 class="name" id=".throwSanitizedRateLimitError"><span class="type-signature">(static) </span>throwSanitizedRateLimitError<span class="signature">(error, msg)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Throws a sanitized rate limit error if detected, otherwise logs and throws the original error.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>error</code></td>
            

            <td class="type">
            
                
<span class="param-type">unknown</span>


            
            </td>

            

            

            <td class="description last">The error to check.</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>msg</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Message to log.</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        Throws a user-friendly rate limit warning or the original error.
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">string</span>
|

<span class="param-type">unknown</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    







        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-collection_helpers.html">collection_helpers</a></li></ul><h3>Classes</h3><ul><li><a href="Account.html">Account</a></li><li><a href="BooleanFilter.html">BooleanFilter</a></li><li><a href="MastoApi.html">MastoApi</a></li><li><a href="NumericFilter.html">NumericFilter</a></li><li><a href="ObjWithCountList.html">ObjWithCountList</a></li><li><a href="TagList.html">TagList</a></li><li><a href="TheAlgorithm.html">TheAlgorithm</a></li><li><a href="Toot.html">Toot</a></li><li><a href="TootFilter.html">TootFilter</a></li><li><a href="UserData.html">UserData</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ALL_CACHE_KEYS">ALL_CACHE_KEYS</a></li><li><a href="global.html#AlgorithmStorageKey">AlgorithmStorageKey</a></li><li><a href="global.html#BooleanFilterName">BooleanFilterName</a></li><li><a href="global.html#CacheKey">CacheKey</a></li><li><a href="global.html#MediaCategory">MediaCategory</a></li><li><a href="global.html#NonScoreWeightName">NonScoreWeightName</a></li><li><a href="global.html#ScoreName">ScoreName</a></li><li><a href="global.html#TagTootsCacheKey">TagTootsCacheKey</a></li><li><a href="global.html#TrendingType">TrendingType</a></li><li><a href="global.html#TypeFilterName">TypeFilterName</a></li><li><a href="global.html#isAccessTokenRevokedError">isAccessTokenRevokedError</a></li><li><a href="global.html#isRateLimitError">isRateLimitError</a></li><li><a href="global.html#isTypeFilterName">isTypeFilterName</a></li><li><a href="global.html#isValueInStringEnum">isValueInStringEnum</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Mon Jun 09 2025 18:54:12 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>